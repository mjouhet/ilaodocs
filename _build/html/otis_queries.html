

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OTIS-related queries &mdash; ILAO 2.19.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OTIS Database Tables &amp; Relationships" href="otis_technical.html" />
    <link rel="prev" title="Triage &amp; Intake Statuses" href="otis_status.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ILAO
          

          
          </a>

          
            
            
              <div class="version">
                2.19.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="get_legal_help.html">Get Legal Help</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="referrals.html">Referrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal_self_help_centers.html">Legal Self-Help Center Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_integration.html">Online Triage and Intake System (OTIS)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OTIS-related queries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-any-triage-rules">Legal issues with any triage rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-published-triage-rules">Legal issues with published triage rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-no-triage-rules-regardless-of-level">Legal issues with no triage rules, regardless of level</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-no-triage-rules-lowest-level-terms-only">Legal issues with no triage rules, lowest level terms only</a></li>
<li class="toctree-l3"><a class="reference internal" href="#queries-for-geographic-reach">Queries for Geographic Reach</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#intake-settings">Intake Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#services">Services</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triage-user">Triage User</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triage-user-legal-problem">Triage user legal problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triage-user-population">Triage user population</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Intake Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#intake-settings-legal-issues">Intake settings &amp; Legal issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#financial-categories-per-intake-setting">Financial Categories per Intake Setting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#intake-settings-waive-income-based-on-population">Intake settings: waive Income based on population</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#triage-rules">Triage Rules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#list-of-triage-rules">List of triage rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triage-rules-with-associated-services">Triage rules with associated services</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triage-rules-with-associated-legal-issues">Triage rules with associated legal issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triage-rules-webform-components">Triage rules webform components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#triage-rules-webform-conditionals">Triage rules webform conditionals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#services-with-online-intake">Services with Online Intake</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#list-of-services-that-have-at-least-one-intake-settings">List of services that have at least one intake settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-of-services-with-limited-populations-served">List of services with limited populations served</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-of-services-with-lowest-level-legal-issues">List of services with lowest-level legal issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="#services-by-geographic-coverage">Services by geographic coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#services-vs-intake-settings-geographic-coverage">Services vs intake settings geographic coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#services-by-eligibility-type">Services by eligibility type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#legal-issues-combined-table">Legal issues combined table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#help-type-requested-by-triage-user">Help type requested by triage user</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="otis_technical.html">OTIS Database Tables &amp; Relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_api.html">Get Legal Help APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="legal_information.html">Legal Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_legal_professionals.html">For Legal Professionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="site_search.html">Site Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="site_faqs.html">Site FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_us.html">ILAO Organization Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="ilao_blog.html">ILAO Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="comments_ratings.html">Comments &amp; Ratings System</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_engagement.html">Share Bar &amp; Favorites</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact_us.html">Contacting ILAO</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_content.html">Content Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_people.html">User Accounts &amp; Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_organizations.html">Managing Organizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech_mailchimp.html">Mailchimp Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech_google_groups.html">Discussion Boards &amp; Google Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="technical_information.html">Other Site Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="seo.html">SEO Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation_management.html">Translation Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="sms_integrations.html">SMS Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_integrations.html">Data Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech_styles.html">Website Styles</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ILAO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="get_legal_help.html">Get Legal Help</a> &raquo;</li>
        
      <li>OTIS-related queries</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/otis_queries.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="otis-related-queries">
<h1>OTIS-related queries<a class="headerlink" href="#otis-related-queries" title="Permalink to this headline">¶</a></h1>
<div class="section" id="legal-issues-with-any-triage-rules">
<h2>Legal issues with any triage rules<a class="headerlink" href="#legal-issues-with-any-triage-rules" title="Permalink to this headline">¶</a></h2>
<p>Returns all triage rules with their associated taxonomy terms.</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="k">distinct</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span><span class="p">,</span>
<span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="p">.</span><span class="n">title_field_value</span>
<span class="k">from</span> <span class="n">taxonomy_entity_index</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">field_data_title_field</span> <span class="k">on</span> <span class="n">field_data_title_field</span><span class="p">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">where</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="k">and</span> <span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;field_legal_issues&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-with-published-triage-rules">
<h2>Legal issues with published triage rules<a class="headerlink" href="#legal-issues-with-published-triage-rules" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span><span class="p">,</span>
<span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="p">.</span><span class="n">title_field_value</span>
<span class="k">from</span> <span class="n">taxonomy_entity_index</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">field_data_title_field</span>
<span class="k">on</span> <span class="n">field_data_title_field</span><span class="p">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">where</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="k">AND</span> <span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;field_legal_issues&#39;</span>
<span class="k">AND</span> <span class="n">node</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-with-no-triage-rules-regardless-of-level">
<h2>Legal issues with no triage rules, regardless of level<a class="headerlink" href="#legal-issues-with-no-triage-rules-regardless-of-level" title="Permalink to this headline">¶</a></h2>
<p>The tid not in clause excludes terms under About Lawyers, Courts &amp; Hearings, and Practice Resources.</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span>SELECT tid, name from taxonomy_term_data where tid not in
(SELECT taxonomy_entity_index.tid from taxonomy_entity_index
inner join taxonomy_term_data
on taxonomy_entity_index.tid = taxonomy_term_data.tid
inner join node on nid = taxonomy_entity_index.entity_id
inner join field_data_title_field on field_data_title_field.entity_id = nid
WHERE taxonomy_entity_index.bundle = &#39;triage_rules&#39;
AND field_name = &#39;field_legal_issues&#39; and node.status = 1)
AND vid = 61 and tid not in
(517836, 517841, 517846, 524176, 524156, 524161, 524221,
524171, 524211, 524181, 524236, 524306, 517851, 517856,
517866, 517896, 517906, 517901, 522986, 517911, 517861,
517921, 517936, 517926, 517916, 517931, 517941, 517946,
522646, 517951, 517956, 517966, 517976, 517961, 517971,
 517871, 517876, 517886, 517891, 517881)
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-with-no-triage-rules-lowest-level-terms-only">
<h2>Legal issues with no triage rules, lowest level terms only<a class="headerlink" href="#legal-issues-with-no-triage-rules-lowest-level-terms-only" title="Permalink to this headline">¶</a></h2>
<p>The tid not in clause excludes terms under About Lawyers, Courts &amp; Hearings, and Practice Resources. Only taxonomy terms that are not parent terms are included.  This means only those terms that are the lowest level terms are returned.</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span>SELECT tid, name from taxonomy_term_data where tid not in
(SELECT taxonomy_entity_index.tid from taxonomy_entity_index
inner join taxonomy_term_data
on taxonomy_entity_index.tid = taxonomy_term_data.tid
inner join node on nid = taxonomy_entity_index.entity_id
inner join field_data_title_field on field_data_title_field.entity_id = nid
WHERE taxonomy_entity_index.bundle = &#39;triage_rules&#39;
AND field_name = &#39;field_legal_issues&#39; and node.status = 1)
AND vid = 61 and tid not in
(517836, 517841, 517846, 524176, 524156, 524161, 524221,
524171, 524211, 524181, 524236, 524306, 517851, 517856,
517866, 517896, 517906, 517901, 522986, 517911, 517861,
517921, 517936, 517926, 517916, 517931, 517941, 517946,
522646, 517951, 517956, 517966, 517976, 517961, 517971,
517871, 517876, 517886, 517891, 517881)
and tid not in (SELECT parent from taxonomy_term_hierarchy)
</pre></div>
</div>
</div>
<div class="section" id="queries-for-geographic-reach">
<h2>Queries for Geographic Reach<a class="headerlink" href="#queries-for-geographic-reach" title="Permalink to this headline">¶</a></h2>
<div class="section" id="intake-settings">
<h3>Intake Settings<a class="headerlink" href="#intake-settings" title="Permalink to this headline">¶</a></h3>
<div class="section" id="gets-all-intake-settings-by-zip-code-when-coded-by-city">
<h4>Gets all intake settings by zip code when coded by city<a class="headerlink" href="#gets-all-intake-settings-by-zip-code-when-coded-by-city" title="Permalink to this headline">¶</a></h4>
<p>Returns all published intake settings and the associated zip codes.</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">zip_code</span>
<span class="k">from</span> <span class="n">field_data_field_cities</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span> <span class="k">and</span> <span class="n">tid</span> <span class="k">in</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
  <span class="k">where</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">field_data_field_cities</span><span class="p">.</span><span class="n">field_cities_target_id</span><span class="p">)</span>
  <span class="k">and</span> <span class="n">entity_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">intake_settings_id</span>
                <span class="k">from</span> <span class="n">oas_intake_settings</span>
                <span class="k">where</span> <span class="n">enabled</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="gets-all-intake-settings-by-zip-code-when-coded-to-counties">
<h4>Gets all intake settings by zip code when coded to counties<a class="headerlink" href="#gets-all-intake-settings-by-zip-code-when-coded-to-counties" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">zip_code</span>
<span class="k">from</span> <span class="n">field_data_field_counties</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span> <span class="k">and</span> <span class="n">tid</span> <span class="k">in</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span> <span class="p">(</span>
<span class="k">Select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">tid</span>
<span class="k">from</span> <span class="n">taxonomy_term_data</span> <span class="k">where</span> <span class="n">tid</span> <span class="o">=</span> <span class="n">field_data_field_counties</span><span class="p">.</span><span class="n">field_counties_target_id</span><span class="p">)))</span>
  <span class="k">and</span> <span class="n">entity_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">intake_settings_id</span>
                <span class="k">from</span> <span class="n">oas_intake_settings</span>
                <span class="k">where</span> <span class="n">enabled</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="gets-all-illinois-zip-codes-use-for-statewide-intake-settings">
<h4>Gets all Illinois zip codes; use for statewide intake settings<a class="headerlink" href="#gets-all-illinois-zip-codes-use-for-statewide-intake-settings" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_hierarchy</span><span class="p">.</span><span class="n">tid</span>
<span class="k">WHERE</span> <span class="n">parent</span> <span class="k">in</span>
<span class="p">(</span><span class="k">select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
   <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span>
   <span class="p">(</span><span class="k">select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="o">=</span>
   <span class="p">(</span><span class="k">Select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_data</span> <span class="k">where</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">)))</span>
<span class="k">and</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">vid</span> <span class="o">=</span> <span class="mi">76</span>
</pre></div>
</div>
</div>
<div class="section" id="intake-settings-by-geographic-reach">
<h4>Intake settings by geographic reach<a class="headerlink" href="#intake-settings-by-geographic-reach" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span> <span class="k">SELECT</span> <span class="n">intake_settings_id</span><span class="p">,</span>
 <span class="k">CASE</span>
  <span class="k">WHEN</span> <span class="n">intake_settings_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_statewide</span> <span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span> <span class="k">and</span> <span class="n">field_data_field_statewide</span><span class="p">.</span><span class="n">field_statewide_value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;statewide&#39;</span>
  <span class="k">WHEN</span> <span class="n">intake_settings_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_cities</span> <span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;city-limited&#39;</span>
  <span class="k">WHEN</span> <span class="n">intake_settings_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_counties</span> <span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;county-limited&#39;</span>
 <span class="k">ELSE</span> <span class="s1">&#39;localized&#39;</span>
<span class="k">END</span>
<span class="k">from</span> <span class="n">oas_intake_settings</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="services">
<h3>Services<a class="headerlink" href="#services" title="Permalink to this headline">¶</a></h3>
<div class="section" id="gets-all-services-by-zip-code-when-coded-by-city">
<h4>Gets all services by zip code when coded by city<a class="headerlink" href="#gets-all-services-by-zip-code-when-coded-by-city" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span>  <span class="n">nid</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_name</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">zip_code</span>
<span class="k">from</span> <span class="n">field_data_field_cities</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span>
<span class="k">and</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="k">and</span> <span class="n">tid</span> <span class="k">in</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
 <span class="k">where</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">field_data_field_cities</span><span class="p">.</span><span class="n">field_cities_target_id</span><span class="p">)</span>
<span class="k">and</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">oas_intake_settings</span><span class="p">)</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">nid</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>Gets all intake settings by zip code when coded to counties<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span>  <span class="n">nid</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_name</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">zip_code</span>
<span class="k">from</span> <span class="n">field_data_field_counties</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span>
<span class="k">and</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="k">and</span> <span class="n">tid</span> <span class="k">in</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span>
<span class="p">(</span><span class="k">Select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span>
<span class="p">(</span><span class="k">Select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_data</span>
<span class="k">where</span> <span class="n">tid</span> <span class="o">=</span> <span class="n">field_data_field_counties</span><span class="p">.</span><span class="n">field_counties_target_id</span><span class="p">)))</span>
<span class="k">and</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">oas_intake_settings</span><span class="p">)</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">nid</span>
</pre></div>
</div>
</div>
<div class="section" id="gets-all-services-by-zip-code-when-coded-to-zip-code">
<h4>Gets all services by zip code when coded to zip code<a class="headerlink" href="#gets-all-services-by-zip-code-when-coded-to-zip-code" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span>  <span class="n">nid</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_name</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">zip_code</span>
<span class="k">from</span> <span class="n">field_data_field_zipcodes</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">field_data_field_zipcodes</span><span class="p">.</span><span class="n">field_zipcodes_target_id</span> <span class="o">=</span> <span class="n">tid</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span>
<span class="k">and</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="k">and</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">oas_intake_settings</span><span class="p">)</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">nid</span>
</pre></div>
</div>
</div>
<div class="section" id="gets-all-services-by-zip-code-when-statewide">
<h4>Gets all services by zip code when statewide<a class="headerlink" href="#gets-all-services-by-zip-code-when-statewide" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span>  <span class="n">nid</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">node</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_name</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">zip_code</span>
<span class="k">from</span> <span class="n">field_data_field_zipcodes</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">field_data_field_zipcodes</span><span class="p">.</span><span class="n">field_zipcodes_target_id</span> <span class="o">=</span> <span class="n">tid</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span>
<span class="k">and</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="k">and</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">oas_intake_settings</span><span class="p">)</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">nid</span>
</pre></div>
</div>
</div>
<div class="section" id="gets-all-illinois-zip-codes-use-for-statewide-services">
<h4>Gets all Illinois zip codes; use for statewide services<a class="headerlink" href="#gets-all-illinois-zip-codes-use-for-statewide-services" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_hierarchy</span><span class="p">.</span><span class="n">tid</span>
<span class="k">WHERE</span> <span class="n">parent</span> <span class="k">in</span>
<span class="p">(</span><span class="k">select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
   <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span>
   <span class="p">(</span><span class="k">select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="o">=</span>
   <span class="p">(</span><span class="k">Select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_data</span> <span class="k">where</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">)))</span>
<span class="k">and</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">vid</span> <span class="o">=</span> <span class="mi">76</span>
</pre></div>
</div>
</div>
<div class="section" id="services-with-online-intake-settings-by-geographic-reach">
<h4>Services with online intake settings by geographic reach<a class="headerlink" href="#services-with-online-intake-settings-by-geographic-reach" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">nid</span><span class="p">,</span>
<span class="n">title</span> <span class="k">as</span> <span class="n">service_name</span><span class="p">,</span>
<span class="n">status</span><span class="p">,</span>
<span class="k">CASE</span>
 <span class="k">WHEN</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_statewide</span>
   <span class="k">where</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
   <span class="k">and</span> <span class="n">field_data_field_statewide</span><span class="p">.</span><span class="n">field_statewide_value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
   <span class="k">THEN</span> <span class="s1">&#39;statewide&#39;</span>
 <span class="k">WHEN</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_cities</span>
  <span class="k">where</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span><span class="p">)</span>
  <span class="k">THEN</span> <span class="s1">&#39;city-limited&#39;</span>
 <span class="k">WHEN</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_counties</span>
 <span class="k">where</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span><span class="p">)</span>
 <span class="k">THEN</span> <span class="s1">&#39;county-limited&#39;</span>
<span class="k">ELSE</span> <span class="s1">&#39;zip-codes&#39;</span>
<span class="k">END</span>
<span class="k">as</span> <span class="n">geography</span>
<span class="k">from</span> <span class="n">node</span>
<span class="k">where</span> <span class="k">type</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="k">and</span> <span class="n">nid</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">oas_intake_settings</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">nid</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="triage-user">
<h2>Triage User<a class="headerlink" href="#triage-user" title="Permalink to this headline">¶</a></h2>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span>
<span class="n">triage_id</span><span class="p">,</span>
<span class="n">oas_triage_user</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span>
<span class="n">age</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">oas_triage_user</span><span class="o">.</span><span class="n">changed</span><span class="p">)</span> <span class="k">as</span> <span class="n">triage_changed</span><span class="p">,</span>
<span class="n">citizenship</span><span class="p">,</span>
<span class="n">county</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">oas_triage_user</span><span class="o">.</span><span class="n">created</span><span class="p">)</span> <span class="k">as</span> <span class="n">triage_started</span><span class="p">,</span>
<span class="n">ethnicity</span><span class="p">,</span>
<span class="n">gender</span><span class="p">,</span>
<span class="n">household_adults</span><span class="p">,</span>
<span class="n">household_children</span><span class="p">,</span>
<span class="n">household_size</span><span class="p">,</span>
<span class="n">immigrant_status</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">intake_created</span><span class="p">)</span> <span class="k">as</span> <span class="n">intake_started</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">intake_changed</span><span class="p">)</span> <span class="k">as</span> <span class="n">intake_changed</span><span class="p">,</span>
<span class="n">last_screen_viewed</span><span class="p">,</span>
<span class="n">marital_status</span><span class="p">,</span>
<span class="n">overincome</span><span class="p">,</span>
<span class="n">primary_language</span><span class="p">,</span>
<span class="n">race</span><span class="p">,</span>
<span class="n">state</span><span class="p">,</span>
<span class="n">total_income</span><span class="p">,</span>
<span class="n">total_expenses</span><span class="p">,</span>
<span class="n">total_assets</span><span class="p">,</span>
<span class="n">triage_status</span><span class="p">,</span>
<span class="n">zip_code</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="s1">&#39;service&#39;</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span>
<span class="kn">from</span> <span class="nn">oas_triage_user</span>
<span class="n">left</span> <span class="n">outer</span> <span class="n">join</span> <span class="n">oas_intake_settings</span>
<span class="n">on</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span> <span class="o">=</span> <span class="n">oas_triage_user</span><span class="o">.</span><span class="n">intake_organization</span>
<span class="n">where</span> <span class="n">oas_triage_user</span><span class="o">.</span><span class="n">uid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4486</span><span class="p">,</span> <span class="mi">4646</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="ow">and</span> <span class="n">oas_triage_user</span><span class="o">.</span><span class="n">created</span> <span class="o">&gt;</span> <span class="mi">1470064821</span>
</pre></div>
</div>
<div class="section" id="triage-user-legal-problem">
<h3>Triage user legal problem<a class="headerlink" href="#triage-user-legal-problem" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">triage_id</span><span class="p">,</span>
<span class="n">CASE</span>
<span class="n">WHEN</span> <span class="n">triage_id</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">field_data_field_triage_problem_history</span>
  <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span> <span class="n">order</span> <span class="n">by</span> <span class="n">delta</span> <span class="n">desc</span><span class="p">)</span> <span class="n">THEN</span>
  <span class="p">(</span><span class="n">Select</span> <span class="n">field_data_field_triage_problem_history</span><span class="o">.</span><span class="n">field_triage_problem_history_tid</span>
   <span class="kn">from</span> <span class="nn">field_data_field_triage_problem_history</span> <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span> <span class="n">order</span> <span class="n">by</span> <span class="n">delta</span> <span class="n">desc</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ELSE</span>
 <span class="p">(</span><span class="n">Select</span> <span class="n">field_data_field_triage_problem</span><span class="o">.</span><span class="n">field_triage_problem_tid</span> <span class="kn">from</span>
  <span class="nn">field_data_field_triage_problem</span> <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span> <span class="n">limit</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">END</span>
<span class="k">as</span> <span class="n">legal_problem</span><span class="p">,</span>
<span class="n">CASE</span>
<span class="n">WHEN</span> <span class="n">triage_id</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">field_data_field_triage_problem_history</span>
 <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span> <span class="n">order</span> <span class="n">by</span> <span class="n">delta</span> <span class="n">desc</span><span class="p">)</span> <span class="n">THEN</span>
<span class="p">(</span><span class="n">Select</span> <span class="n">name</span> <span class="kn">from</span> <span class="nn">taxonomy_term_data</span> <span class="n">where</span> <span class="n">tid</span> <span class="o">=</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">field_data_field_triage_problem_history</span><span class="o">.</span><span class="n">field_triage_problem_history_tid</span> <span class="kn">from</span> <span class="nn">field_data_field_triage_problem_history</span> <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span> <span class="n">order</span> <span class="n">by</span> <span class="n">delta</span> <span class="n">desc</span> <span class="n">LIMIT</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ELSE</span>
 <span class="p">(</span><span class="n">Select</span> <span class="n">name</span> <span class="kn">from</span> <span class="nn">taxonomy_term_data</span> <span class="n">where</span> <span class="n">tid</span> <span class="o">=</span>
 <span class="p">(</span><span class="n">Select</span> <span class="n">field_data_field_triage_problem</span><span class="o">.</span><span class="n">field_triage_problem_tid</span> <span class="kn">from</span>
  <span class="nn">field_data_field_triage_problem</span> <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span> <span class="n">limit</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">END</span>
<span class="k">as</span> <span class="n">legal_problem_name</span>
<span class="kn">from</span> <span class="nn">oas_triage_user</span>
<span class="n">where</span> <span class="n">oas_triage_user</span><span class="o">.</span><span class="n">uid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4486</span><span class="p">,</span> <span class="mi">4646</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="ow">and</span> <span class="n">oas_triage_user</span><span class="o">.</span><span class="n">created</span> <span class="o">&gt;</span> <span class="mi">1470064821</span>
</pre></div>
</div>
</div>
<div class="section" id="triage-user-population">
<h3>Triage user population<a class="headerlink" href="#triage-user-population" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">entity_id</span> <span class="k">as</span> <span class="n">triage_id</span><span class="p">,</span>
<span class="n">field_limited_populations_tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">population_name</span><span class="p">,</span>
<span class="n">FROM</span> <span class="n">field_data_field_limited_populations</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">taxonomy_term_data</span> <span class="n">on</span> <span class="n">taxonomy_term_data</span><span class="o">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">field_limited_populations_tid</span>
<span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Intake Settings<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span> <span class="n">Select</span> <span class="n">title</span> <span class="k">as</span> <span class="n">service</span><span class="p">,</span>
 <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">service_id</span><span class="p">,</span>
 <span class="n">intake_settings_id</span><span class="p">,</span>
 <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
 <span class="n">allow_prisoners</span><span class="p">,</span>
 <span class="n">apply_asset_limit</span><span class="p">,</span>
 <span class="n">apply_income_limit</span><span class="p">,</span>
 <span class="n">callback_number</span><span class="p">,</span>
 <span class="n">callback_type</span><span class="p">,</span>
 <span class="n">from_unixtime</span><span class="p">(</span><span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">changed</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;last_updated&#39;</span><span class="p">,</span>
 <span class="n">collect_assets</span><span class="p">,</span>
 <span class="n">collect_citizenship</span><span class="p">,</span>
 <span class="n">collect_country</span><span class="p">,</span>
 <span class="n">collect_language</span><span class="p">,</span>
 <span class="n">collect_gender</span><span class="p">,</span>
 <span class="n">collect_race</span><span class="p">,</span>
 <span class="n">collect_ethnicity</span><span class="p">,</span>
 <span class="n">collect_income</span><span class="p">,</span>
 <span class="n">collect_assets</span><span class="p">,</span>
 <span class="n">collect_expenses</span><span class="p">,</span>
 <span class="n">collect_expenses_over_income</span><span class="p">,</span>
 <span class="n">from_unixtime</span><span class="p">(</span><span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">created</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;created&#39;</span><span class="p">,</span>
 <span class="n">enabled</span><span class="p">,</span>
 <span class="n">intake_limit</span><span class="p">,</span>
 <span class="n">maximum_allowed_income</span><span class="p">,</span>
 <span class="n">maximum_allowed_assets</span><span class="p">,</span>
 <span class="n">maximum_callbacks_per_slot</span><span class="p">,</span>
 <span class="n">minimum_minor_age</span><span class="p">,</span>
 <span class="n">minimum_senior_age</span><span class="p">,</span>
 <span class="n">personal_exemption_amount</span><span class="p">,</span>
 <span class="n">CASE</span>
  <span class="n">WHEN</span> <span class="n">intake_limit</span> <span class="o">!=</span> <span class="mi">0</span> <span class="n">THEN</span>
  <span class="n">CASE</span>
    <span class="n">WHEN</span> <span class="n">reset_limit_frequency</span> <span class="o">=</span> <span class="mi">1</span> <span class="n">THEN</span> <span class="s1">&#39;per day&#39;</span>
    <span class="n">WHEN</span> <span class="n">reset_limit_frequency</span> <span class="o">=</span> <span class="mi">7</span> <span class="n">THEN</span> <span class="s1">&#39;per week&#39;</span>
    <span class="n">WHEN</span> <span class="n">reset_limit_frequency</span> <span class="o">=</span> <span class="mi">30</span> <span class="n">THEN</span> <span class="s1">&#39;per month&#39;</span>
  <span class="n">END</span>
  <span class="n">ELSE</span> <span class="s1">&#39;unlimited&#39;</span>
<span class="n">END</span>
<span class="k">as</span> <span class="n">reset_limit_frequency</span><span class="p">,</span>
<span class="n">CASE</span>
  <span class="n">WHEN</span> <span class="n">intake_settings_id</span> <span class="ow">in</span>
   <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">field_data_field_statewide</span>
   <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span>
   <span class="ow">and</span> <span class="n">field_data_field_statewide</span><span class="o">.</span><span class="n">field_statewide_value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
   <span class="n">THEN</span> <span class="s1">&#39;statewide&#39;</span>
  <span class="n">WHEN</span> <span class="n">intake_settings_id</span> <span class="ow">in</span>
   <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">field_data_field_cities</span>
    <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;city-limited&#39;</span>
  <span class="n">WHEN</span> <span class="n">intake_settings_id</span> <span class="ow">in</span>
   <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">field_data_field_counties</span>
   <span class="n">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span><span class="p">)</span>
   <span class="n">THEN</span> <span class="s1">&#39;county-limited&#39;</span>
 <span class="n">ELSE</span> <span class="s1">&#39;localized&#39;</span>
 <span class="n">END</span>
<span class="k">as</span> <span class="n">geographic_reach</span><span class="p">,</span>
<span class="n">ilao_oas_income_standard</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="s1">&#39;income_standard&#39;</span>
<span class="kn">from</span> <span class="nn">oas_intake_settings</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span> <span class="n">on</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_oas_income_standard</span> <span class="n">ON</span>
<span class="n">field_data_oas_income_standard</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">intake_settings_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">ilao_oas_income_standard</span> <span class="n">on</span>
<span class="n">ilao_oas_income_standard</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span>
<span class="n">field_data_oas_income_standard</span><span class="o">.</span><span class="n">oas_income_standard_target_id</span>
</pre></div>
</div>
<div class="section" id="intake-settings-legal-issues">
<h3>Intake settings &amp; Legal issues<a class="headerlink" href="#intake-settings-legal-issues" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">intake_settings_name</span><span class="p">,</span>
<span class="n">enabled</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">created</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;created&#39;</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">changed</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;last_updated&#39;</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">legal_issue</span>
<span class="kn">from</span> <span class="nn">oas_intake_settings</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_field_legal_issues</span> <span class="n">on</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">intake_settings_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">taxonomy_term_data</span> <span class="n">on</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">field_legal_issues_tid</span> <span class="o">=</span> <span class="n">tid</span>
<span class="n">where</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span>
<span class="ow">and</span> <span class="n">tid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">parent</span> <span class="kn">from</span> <span class="nn">taxonomy_term_hierarchy</span> <span class="n">where</span> <span class="n">taxonomy_term_hierarchy</span><span class="o">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">tid</span><span class="p">)</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">intake_settings_id</span>
</pre></div>
</div>
</div>
<div class="section" id="financial-categories-per-intake-setting">
<h3>Financial Categories per Intake Setting<a class="headerlink" href="#financial-categories-per-intake-setting" title="Permalink to this headline">¶</a></h3>
<div class="section" id="assets">
<h4>Assets<a class="headerlink" href="#assets" title="Permalink to this headline">¶</a></h4>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">field_data_oas_asset_categories</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">intake_settings_name</span><span class="p">,</span>
<span class="n">oas_asset_categories_target_id</span> <span class="k">as</span> <span class="n">financial_id</span><span class="p">,</span>
<span class="n">ilao_oas_financial_category</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">asset</span><span class="p">,</span>
<span class="n">subcategory</span>
<span class="n">FROM</span> <span class="n">field_data_oas_asset_categories</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">oas_intake_settings</span>
<span class="n">on</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span> <span class="o">=</span>
 <span class="n">field_data_oas_asset_categories</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">ilao_oas_financial_category</span>
<span class="n">on</span> <span class="n">ilao_oas_financial_category</span><span class="o">.</span><span class="n">ilao_oas_financial_category_id</span> <span class="o">=</span>
<span class="n">oas_asset_categories_target_id</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span><span class="p">,</span> <span class="n">delta</span>
</pre></div>
</div>
</div>
<div class="section" id="income">
<h4>Income<a class="headerlink" href="#income" title="Permalink to this headline">¶</a></h4>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">field_data_oas_income_categories</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">intake_settings_name</span><span class="p">,</span>
<span class="n">oas_income_categories_target_id</span> <span class="k">as</span> <span class="n">financial_id</span><span class="p">,</span>
<span class="n">ilao_oas_financial_category</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">income</span><span class="p">,</span>
<span class="n">subcategory</span>
<span class="n">FROM</span> <span class="n">field_data_oas_income_categories</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">oas_intake_settings</span>
<span class="n">on</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span> <span class="o">=</span>
 <span class="n">field_data_oas_income_categories</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">ilao_oas_financial_category</span>
<span class="n">on</span> <span class="n">ilao_oas_financial_category</span><span class="o">.</span><span class="n">ilao_oas_financial_category_id</span> <span class="o">=</span>
<span class="n">oas_income_categories_target_id</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span><span class="p">,</span> <span class="n">delta</span>
</pre></div>
</div>
</div>
<div class="section" id="expenses">
<h4>Expenses<a class="headerlink" href="#expenses" title="Permalink to this headline">¶</a></h4>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">field_data_oas_expense_categories</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">intake_settings_name</span><span class="p">,</span>
<span class="n">oas_expense_categories_target_id</span> <span class="k">as</span> <span class="n">financial_id</span><span class="p">,</span>
<span class="n">ilao_oas_financial_category</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">income</span><span class="p">,</span>
<span class="n">subcategory</span>
<span class="n">FROM</span> <span class="n">field_data_oas_expense_categories</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">oas_intake_settings</span>
<span class="n">on</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span> <span class="o">=</span>
 <span class="n">field_data_oas_expense_categories</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">ilao_oas_financial_category</span>
<span class="n">on</span> <span class="n">ilao_oas_financial_category</span><span class="o">.</span><span class="n">ilao_oas_financial_category_id</span> <span class="o">=</span>
<span class="n">oas_expense_categories_target_id</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">intake_settings_id</span><span class="p">,</span> <span class="n">delta</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="intake-settings-waive-income-based-on-population">
<h3>Intake settings: waive Income based on population<a class="headerlink" href="#intake-settings-waive-income-based-on-population" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">field_data_oas_income_exempt</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">oas_income_exempt_tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">population</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">enabled</span> <span class="k">as</span> <span class="n">status</span>
<span class="kn">from</span> <span class="nn">field_data_oas_income_exempt</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">taxonomy_term_data</span> <span class="n">on</span> <span class="n">tid</span> <span class="o">=</span> <span class="n">oas_income_exempt_tid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">oas_intake_settings</span> <span class="n">on</span> <span class="n">intake_settings_id</span> <span class="o">=</span> <span class="n">field_data_oas_income_exempt</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">where</span> <span class="n">field_data_oas_income_exempt</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="triage-rules">
<h2>Triage Rules<a class="headerlink" href="#triage-rules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="list-of-triage-rules">
<h3>List of triage rules<a class="headerlink" href="#list-of-triage-rules" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="n">nid</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="o">.</span><span class="n">title_field_value</span> <span class="k">as</span> <span class="n">title</span><span class="p">,</span>
<span class="n">status</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">created</span><span class="p">)</span> <span class="k">as</span> <span class="n">created</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">changed</span><span class="p">)</span> <span class="k">as</span> <span class="n">last_updated</span>
<span class="kn">from</span> <span class="nn">node</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_title_field</span> <span class="n">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">field_data_title_field</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">where</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="triage-rules-with-associated-services">
<h3>Triage rules with associated services<a class="headerlink" href="#triage-rules-with-associated-services" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="o">.</span><span class="n">title_field_value</span> <span class="k">as</span> <span class="n">title</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">created</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;created&#39;</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">changed</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;last_updated&#39;</span><span class="p">,</span>
<span class="n">field_data_field_service</span><span class="o">.</span><span class="n">field_service_target_id</span> <span class="k">as</span> <span class="s1">&#39;service_id&#39;</span><span class="p">,</span>
<span class="n">services</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="s1">&#39;service_title&#39;</span>
<span class="kn">from</span> <span class="nn">node</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_title_field</span> <span class="n">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">field_data_title_field</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_field_service</span> <span class="n">ON</span>
<span class="n">field_data_field_service</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span> <span class="k">as</span> <span class="n">services</span> <span class="n">ON</span>
<span class="n">services</span><span class="o">.</span><span class="n">nid</span> <span class="o">=</span> <span class="n">field_data_field_service</span><span class="o">.</span><span class="n">field_service_target_id</span>
<span class="n">where</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="triage-rules-with-associated-legal-issues">
<h3>Triage rules with associated legal issues<a class="headerlink" href="#triage-rules-with-associated-legal-issues" title="Permalink to this headline">¶</a></h3>
<p>Mapping of legal issues tagged to a triage rules item.  Note that this query excludes anything but lowest level terms because legal issue must be an exact match.</p>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="o">.</span><span class="n">title_field_value</span> <span class="k">as</span> <span class="n">title</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">created</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;created&#39;</span><span class="p">,</span>
<span class="n">from_unixtime</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">changed</span><span class="p">)</span> <span class="k">as</span> <span class="s1">&#39;last_updated&#39;</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">legal_issue</span>
<span class="kn">from</span> <span class="nn">node</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_title_field</span> <span class="n">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">field_data_title_field</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_field_legal_issues</span> <span class="n">on</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">taxonomy_term_data</span> <span class="n">on</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">field_legal_issues_tid</span> <span class="o">=</span> <span class="n">tid</span>
<span class="n">where</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="ow">and</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="ow">and</span> <span class="n">tid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">parent</span> <span class="kn">from</span> <span class="nn">taxonomy_term_hierarchy</span> <span class="n">where</span> <span class="n">taxonomy_term_hierarchy</span><span class="o">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">tid</span><span class="p">)</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">nid</span>
</pre></div>
</div>
</div>
<div class="section" id="triage-rules-webform-components">
<h3>Triage rules webform components<a class="headerlink" href="#triage-rules-webform-components" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="k">as</span> <span class="n">triage_rules_id</span><span class="p">,</span>
<span class="n">cid</span> <span class="k">as</span> <span class="n">component_id</span><span class="p">,</span>
<span class="n">form_key</span><span class="p">,</span>
<span class="n">name</span><span class="p">,</span>
<span class="n">webform_component</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
<span class="n">value</span><span class="p">,</span>
<span class="n">status</span>
<span class="n">FROM</span> <span class="n">webform_component</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span> <span class="n">on</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="o">=</span> <span class="n">webform_component</span><span class="o">.</span><span class="n">nid</span>
<span class="n">where</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span><span class="p">,</span> <span class="n">cid</span>
</pre></div>
</div>
</div>
<div class="section" id="triage-rules-webform-conditionals">
<h3>Triage rules webform conditionals<a class="headerlink" href="#triage-rules-webform-conditionals" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">webform_conditional_rules</span><span class="o">.</span><span class="n">nid</span><span class="p">,</span>
<span class="n">webform_conditional_rules</span><span class="o">.</span><span class="n">rgid</span><span class="p">,</span>
<span class="n">rid</span><span class="p">,</span>
<span class="n">source_type</span><span class="p">,</span>
<span class="n">source</span><span class="p">,</span>
<span class="n">operator</span><span class="p">,</span>
<span class="n">value</span><span class="p">,</span>
<span class="n">action</span><span class="p">,</span>
<span class="n">argument</span>
<span class="n">FROM</span> <span class="n">webform_conditional_rules</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">webform_conditional_actions</span>
<span class="n">on</span> <span class="n">webform_conditional_rules</span><span class="o">.</span><span class="n">rgid</span> <span class="o">=</span> <span class="n">webform_conditional_actions</span><span class="o">.</span><span class="n">rgid</span>
<span class="n">order</span> <span class="n">by</span> <span class="n">webform_conditional_rules</span><span class="o">.</span><span class="n">nid</span><span class="p">,</span> <span class="n">webform_conditional_rules</span><span class="o">.</span><span class="n">rgid</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="services-with-online-intake">
<h2>Services with Online Intake<a class="headerlink" href="#services-with-online-intake" title="Permalink to this headline">¶</a></h2>
<div class="section" id="list-of-services-that-have-at-least-one-intake-settings">
<h3>List of services that have at least one intake settings<a class="headerlink" href="#list-of-services-that-have-at-least-one-intake-settings" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="k">as</span> <span class="n">service_id</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">field_data_field_location_ref</span><span class="o">.</span><span class="n">field_location_ref_target_id</span> <span class="k">as</span> <span class="n">location_id</span><span class="p">,</span>
<span class="n">locations</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span>
<span class="n">og_membership</span><span class="o">.</span><span class="n">gid</span> <span class="k">as</span> <span class="n">organization_id</span><span class="p">,</span>
<span class="n">organizations</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">organization_name</span>
<span class="kn">from</span> <span class="nn">node</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_field_location_ref</span> <span class="n">on</span> <span class="n">field_data_field_location_ref</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">og_membership</span> <span class="n">on</span> <span class="n">etid</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span> <span class="k">as</span> <span class="n">locations</span>
<span class="n">on</span> <span class="n">locations</span><span class="o">.</span><span class="n">nid</span> <span class="o">=</span> <span class="n">field_data_field_location_ref</span><span class="o">.</span><span class="n">field_location_ref_target_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span> <span class="k">as</span> <span class="n">organizations</span>
<span class="n">on</span> <span class="n">og_membership</span><span class="o">.</span><span class="n">gid</span> <span class="o">=</span> <span class="n">organizations</span><span class="o">.</span><span class="n">nid</span>
<span class="n">where</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">oas_intake_settings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="list-of-services-with-limited-populations-served">
<h3>List of services with limited populations served<a class="headerlink" href="#list-of-services-with-limited-populations-served" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="k">as</span> <span class="n">service_id</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">status</span><span class="p">,</span>
<span class="n">field_data_field_limited_populations</span><span class="o">.</span><span class="n">field_limited_populations_tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">population</span>
<span class="kn">from</span> <span class="nn">node</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_field_limited_populations</span> <span class="n">on</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">taxonomy_term_data</span> <span class="n">on</span> <span class="n">tid</span> <span class="o">=</span> <span class="n">field_data_field_limited_populations</span><span class="o">.</span><span class="n">field_limited_populations_tid</span>
<span class="n">where</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">oas_intake_settings</span><span class="p">)</span>
<span class="ow">and</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="list-of-services-with-lowest-level-legal-issues">
<h3>List of services with lowest-level legal issues<a class="headerlink" href="#list-of-services-with-lowest-level-legal-issues" title="Permalink to this headline">¶</a></h3>
<p>We use only the lowest level since that’s what users are forced to drill down to.</p>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="k">as</span> <span class="n">service_id</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_title</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
<span class="n">tid</span> <span class="k">as</span> <span class="n">term_id</span><span class="p">,</span>
<span class="n">name</span> <span class="k">as</span> <span class="n">legal_issue</span>

<span class="kn">from</span> <span class="nn">node</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">field_data_field_legal_issues</span>
<span class="n">on</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="o">=</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">taxonomy_term_data</span>
<span class="n">on</span> <span class="n">taxonomy_term_data</span><span class="o">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">field_data_field_legal_issues</span><span class="o">.</span><span class="n">field_legal_issues_tid</span>

<span class="n">where</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">oas_intake_settings</span><span class="p">)</span>
<span class="ow">and</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
 <span class="ow">and</span> <span class="n">tid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">parent</span> <span class="kn">from</span> <span class="nn">taxonomy_term_hierarchy</span>
               <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="services-by-geographic-coverage">
<h3>Services by geographic coverage<a class="headerlink" href="#services-by-geographic-coverage" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="services-vs-intake-settings-geographic-coverage">
<h3>Services vs intake settings geographic coverage<a class="headerlink" href="#services-vs-intake-settings-geographic-coverage" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">name</span> <span class="k">as</span> <span class="n">intake_settings</span><span class="p">,</span>
<span class="n">field_data_field_same_service_area_as_locat</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">intake_settings_id</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">enabled</span> <span class="k">as</span> <span class="n">status</span><span class="p">,</span>
<span class="n">field_data_field_same_service_area_as_locat</span><span class="o">.</span><span class="n">field_same_service_area_as_locat_value</span>
 <span class="k">as</span> <span class="n">has_same_geographic_area</span><span class="p">,</span>
<span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">entity_id</span> <span class="k">as</span> <span class="n">service_id</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">service_name</span><span class="p">,</span>
<span class="n">node</span><span class="o">.</span><span class="n">status</span> <span class="k">as</span> <span class="n">service_status</span>
<span class="kn">from</span> <span class="nn">field_data_field_same_service_area_as_locat</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">oas_intake_settings</span>
<span class="n">on</span> <span class="n">intake_settings_id</span> <span class="o">=</span> <span class="n">field_data_field_same_service_area_as_locat</span><span class="o">.</span><span class="n">entity_id</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span>
<span class="n">on</span> <span class="n">oas_intake_settings</span><span class="o">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span>
<span class="n">where</span> <span class="n">field_data_field_same_service_area_as_locat</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="services-by-eligibility-type">
<h3>Services by eligibility type<a class="headerlink" href="#services-by-eligibility-type" title="Permalink to this headline">¶</a></h3>
<div class="code sql highlight-default"><div class="highlight"><pre><span></span> <span class="n">Select</span> <span class="n">entity_id</span> <span class="k">as</span> <span class="n">service_id</span> <span class="p">,</span> <span class="n">title</span> <span class="k">as</span> <span class="n">service_name</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span>
 <span class="n">CASE</span>
  <span class="n">WHEN</span> <span class="n">field_service_eligibility_value</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="n">THEN</span> <span class="s1">&#39;Free to everyone&#39;</span>
  <span class="n">WHEN</span> <span class="n">field_service_eligibility_value</span> <span class="o">=</span> <span class="mi">2</span>
   <span class="n">THEN</span> <span class="s1">&#39;Free to eligible persons&#39;</span>
  <span class="n">WHEN</span> <span class="n">field_service_eligibility_value</span> <span class="o">=</span> <span class="mi">3</span>
   <span class="n">THEN</span> <span class="s1">&#39;Sliding scale&#39;</span>
  <span class="n">WHEN</span> <span class="n">field_service_eligibility_value</span> <span class="o">=</span> <span class="mi">4</span>
   <span class="n">THEN</span> <span class="s1">&#39;Flat fee&#39;</span>
<span class="n">END</span>
<span class="k">as</span> <span class="n">income_eligibility</span>
<span class="kn">from</span> <span class="nn">field_data_field_service_eligibility</span>
<span class="n">inner</span> <span class="n">join</span> <span class="n">node</span> <span class="n">on</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="n">where</span> <span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;location_services&#39;</span>
<span class="ow">and</span> <span class="n">nid</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Select</span> <span class="n">entity_id</span> <span class="kn">from</span> <span class="nn">oas_intake_settings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-combined-table">
<h3>Legal issues combined table<a class="headerlink" href="#legal-issues-combined-table" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="n">triage_id</span><span class="p">,</span> <span class="n">intake_status</span><span class="p">,</span>
<span class="n">field_data_field_triage_problem</span><span class="p">.</span><span class="n">field_triage_problem_tid</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="p">(</span><span class="k">Select</span> <span class="n">name</span> <span class="k">from</span> <span class="n">taxonomy_term_data</span> <span class="k">where</span> <span class="n">tid</span> <span class="o">=</span>
<span class="p">(</span><span class="k">Select</span> <span class="n">field_data_field_triage_problem_history</span><span class="p">.</span><span class="n">field_triage_problem_history_tid</span>
<span class="k">from</span> <span class="n">field_data_field_triage_problem_history</span>
<span class="k">where</span> <span class="n">entity_id</span> <span class="o">=</span> <span class="n">triage_id</span>
<span class="k">and</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_triage_user&#39;</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">delta</span> <span class="k">DESC</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">limit</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">as</span> <span class="n">history</span>
<span class="k">from</span> <span class="n">oas_triage_user</span>
<span class="k">left</span> <span class="k">join</span> <span class="n">field_data_field_triage_problem</span> <span class="k">on</span>
<span class="n">field_data_field_triage_problem</span><span class="p">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">triage_id</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span> <span class="k">on</span> <span class="n">tid</span> <span class="o">=</span>
<span class="n">field_data_field_triage_problem</span><span class="p">.</span><span class="n">field_triage_problem_tid</span>
<span class="k">order</span> <span class="k">by</span> <span class="n">triage_id</span> <span class="k">DESC</span>
</pre></div>
</div>
</div>
<div class="section" id="help-type-requested-by-triage-user">
<h3>Help type requested by triage user<a class="headerlink" href="#help-type-requested-by-triage-user" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">triage_id</span><span class="p">,</span>
<span class="n">GROUP_CONCAT</span><span class="p">(</span><span class="n">field_data_oas_triage_help_type</span><span class="p">.</span><span class="n">oas_triage_help_type_value</span><span class="p">)</span>
<span class="k">from</span> <span class="n">oas_triage_user</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">field_data_oas_triage_help_type</span> <span class="k">on</span> <span class="n">triage_id</span> <span class="o">=</span> <span class="n">entity_id</span>
<span class="k">group</span> <span class="k">by</span> <span class="n">triage_id</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="otis_technical.html" class="btn btn-neutral float-right" title="OTIS Database Tables &amp; Relationships" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="otis_status.html" class="btn btn-neutral" title="Triage &amp; Intake Statuses" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Illinois Legal Aid Online.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.19.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>